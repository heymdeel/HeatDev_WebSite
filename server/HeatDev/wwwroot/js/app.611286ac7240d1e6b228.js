webpackJsonp([1],{"+GAs":function(e,t){},"3MuA":function(e,t){},"4+hh":function(e,t){},"4XAy":function(e,t){},"5M8p":function(e,t){},"6R2x":function(e,t){},"6yFA":function(e,t){},"7Otq":function(e,t,r){e.exports=r.p+"img/logo.82f5ba4.png"},"9pTX":function(e,t){},FhiH:function(e,t){},IQZh:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),n=r("Xxa5"),s=r.n(n),i=r("exGp"),o=r.n(i),c=r("mvHQ"),d=r.n(c),u=r("mtWM"),l=r.n(u),m=r("ytdl"),v=r.n(m),p=new a.default,_={user:{is_authenticated:!1,access_token:"",refresh_token:"",profile:{name:"",surname:"",phone:"",avatar:""},roles:[],id:0},signIn:function(e){var t=this;return o()(s.a.mark(function r(){var a,n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,l.a.post("/api/auth/sign_in",e);case 3:return a=r.sent,t.readUserData(a),l.a.defaults.headers.common.Authorization="Bearer "+t.user.access_token,r.next=8,l.a.get("/api/users/"+t.user.id+"/profile");case 8:n=r.sent,t.user.profile=n.data,t.storeUserData(),r.next=16;break;case 13:throw r.prev=13,r.t0=r.catch(0),r.t0;case 16:case"end":return r.stop()}},r,t,[[0,13]])}))()},signOut:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.post("/api/auth/token/invalidate",'"'+e.user.refresh_token+'"',{headers:{"Content-Type":"application/json"}});case 3:e.clearAuth(),t.next=13;break;case 6:if(t.prev=6,t.t0=t.catch(0),400!==(r=t.t0.response.status)&&404!==r){t.next=12;break}return e.clearAuth(),t.abrupt("return");case 12:throw t.t0;case 13:case"end":return t.stop()}},t,e,[[0,6]])}))()},signUp:function(e){var t=this;return o()(s.a.mark(function r(){var a,n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,l.a.post("/api/auth/sign_up",e);case 3:return a=r.sent,t.readUserData(a),l.a.defaults.headers.common.Authorization="Bearer "+t.user.access_token,r.next=8,l.a.get("/api/users/"+t.user.id+"/profile");case 8:n=r.sent,t.user.profile=n.data,t.storeUserData(),r.next=16;break;case 13:throw r.prev=13,r.t0=r.catch(0),r.t0;case 16:case"end":return r.stop()}},r,t,[[0,13]])}))()},readUserData:function(e){this.user.access_token=e.data.access_token,this.user.refresh_token=e.data.refresh_token,this.user.roles=e.data.roles,this.user.id=e.data.user_id},storeUserData:function(){this.user.is_authenticated=!0,localStorage.setItem("user",d()(this.user))},clearAuth:function(){l.a.defaults.headers.common.Authorization="",this.user.is_authenticated=!1,localStorage.removeItem("user")},refreshTokens:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.post("/api/auth/token/refresh",'"'+e.user.refresh_token+'"',{headers:{"Content-Type":"application/json"}});case 3:r=t.sent,e.readUserData(r),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},checkTokens:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.tokenisValid(e.user.refresh_token)){t.next=4;break}return e.clearAuth(),p.$emit("user-sign-out"),t.abrupt("return");case 4:if(e.tokenisValid(e.user.access_token)){t.next=20;break}return t.prev=5,t.next=8,e.refreshTokens();case 8:l.a.defaults.headers.common.Authorization="Bearer "+e.user.access_token,e.storeUserData(),t.next=20;break;case 12:if(t.prev=12,t.t0=t.catch(5),console.log(t.t0),400!==(r=t.t0.response.status)&&404!==r){t.next=20;break}return e.clearAuth(),p.$emit("user-sign-out"),t.abrupt("return");case 20:case"end":return t.stop()}},t,e,[[5,12]])}))()},init:function(){var e=localStorage.getItem("user");if(!e)return this.user.is_authenticated=!1,void(l.a.defaults.headers.common.Authorization="");this.user=JSON.parse(e),this.tokenisValid(this.user.refresh_token)?(l.a.defaults.headers.common.Authorization="Bearer "+this.user.access_token,this.storeUserData()):this.clearAuth()},tokenisValid:function(e){var t=v()(e),r=Date.now()/1e3;return!(t.exp<r)},changePassword:function(e,t){var r=this;return o()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.checkTokens();case 2:return a.prev=2,a.next=5,l.a.put("/api/users/"+e+"/password",t);case 5:a.sent,a.next=11;break;case 8:throw a.prev=8,a.t0=a.catch(2),a.t0;case 11:case"end":return a.stop()}},a,r,[[2,8]])}))()},userIsWorker:function(){return this.user.is_authenticated&&this.user.roles.some(function(e){return"worker"==e})},userIsClient:function(){return this.user.is_authenticated&&this.user.roles.some(function(e){return"client"==e})}},h={name:"auth-comp",data:function(){return{credentials:{login:"",password:""},snackbar_message:"",show_dialog:!1,show_snackbar:!1}},methods:{closeSignInDialog:function(){this.show_dialog=!1},openSignInDialog:function(){this.show_dialog=!0},signIn:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(t.sent){t.next=6;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 6:return t.prev=6,p.$emit("global-loading-start"),t.next=10,_.signIn(e.credentials);case 10:p.$emit("user-sign-in"),e.show_dialog=!1,t.next=29;break;case 14:if(t.prev=14,t.t0=t.catch(6),502!==(r=t.t0.response.status)&&504!==r){t.next=21;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 21:if(400!==r){t.next=25;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 25:if(404!==r){t.next=29;break}return e.snackbar_message="Неверный логин/пароль",e.show_snackbar=!0,t.abrupt("return");case 29:return t.prev=29,p.$emit("global-loading-finish"),t.finish(29);case 32:case"end":return t.stop()}},t,e,[[6,14,29,32]])}))()}}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("md-button",{on:{click:function(t){e.$router.push("/sign_up")}}},[e._v("Регистрация")]),e._v(" "),r("md-button",{staticClass:"md-raised md-accent",on:{click:function(t){e.openSignInDialog()}}},[e._v("Войти")]),e._v(" "),r("md-dialog",{attrs:{"md-active":e.show_dialog,"md-theme":"default"},on:{"update:mdActive":function(t){e.show_dialog=t}}},[r("md-dialog-title",[e._v("Авторизация")]),e._v(" "),r("md-dialog-content",[r("form",{attrs:{novalidate:""},on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.submit(t)}}},[r("md-field",{class:{"md-invalid":e.errors.has("login")}},[r("label",[e._v("Логин")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{required:"",name:"login","data-vv-as":"логин","data-vv-name":"login"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signIn(t):null}},model:{value:e.credentials.login,callback:function(t){e.$set(e.credentials,"login",t)},expression:"credentials.login"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("login")))])],1),e._v(" "),r("br"),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("password")},attrs:{"md-has-password":""}},[r("label",[e._v("Пароль")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{required:"",type:"password",name:"password","data-vv-as":"пароль","data-vv-name":"password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signIn(t):null}},model:{value:e.credentials.password,callback:function(t){e.$set(e.credentials,"password",t)},expression:"credentials.password"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("password")))])],1)],1)]),e._v(" "),r("md-dialog-actions",[r("md-button",{staticClass:"md-primary",on:{click:e.closeSignInDialog}},[e._v("Отмена")]),e._v(" "),r("md-button",{staticClass:"md-primary md-raised",on:{click:e.signIn}},[e._v("Войти")])],1)],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var g=r("VU/8")(h,f,!1,function(e){r("6R2x")},"data-v-d0a84dfe",null).exports,k={name:"user-info",data:function(){return{show_snackbar:!1,snackbar_message:"",user:_.user}},computed:{isClient:function(){return _.userIsClient()}},methods:{signOut:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,p.$emit("global-loading-start"),t.next=4,_.signOut();case 4:p.$emit("user-sign-out"),t.next=14;break;case 7:if(t.prev=7,t.t0=t.catch(0),502!==(r=t.t0.response.status)&&504!==r){t.next=14;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 14:return t.prev=14,p.$emit("global-loading-finish"),t.finish(14);case 17:case"end":return t.stop()}},t,e,[[0,7,14,17]])}))()}}},b={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("md-menu",{attrs:{"md-size":"medium","md-align-trigger":""}},[r("md-button",{attrs:{"md-menu-trigger":""}},[r("span",[e._v(e._s(e.user.profile.name))]),e._v(" "),r("md-avatar",[r("img",{attrs:{src:e.user.profile.avatar}})]),e._v(" "),r("md-icon",[e._v("expand_more")])],1),e._v(" "),r("md-menu-content",[r("md-menu-item",{on:{click:function(t){e.$router.push("/profile")}}},[r("span",[e._v("Мой профиль")])]),e._v(" "),e.isClient?r("md-menu-item",{on:{click:function(t){e.$router.push("/myorders")}}},[r("span",[e._v("Мои заявки")])]):e._e(),e._v(" "),r("md-divider"),e._v(" "),r("md-menu-item",{on:{click:e.signOut}},[r("span",[e._v("Выход")]),e._v(" "),r("md-icon",{staticClass:"md-accent",attrs:{"md-theme":"default"}},[e._v("exit_to_app")])],1)],1)],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var w={name:"user-box",components:{"user-info":r("VU/8")(k,b,!1,function(e){r("5M8p")},"data-v-3db18190",null).exports,"auth-comp":g},data:function(){return{user:_.user}}},x={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[this.user.is_authenticated?t("user-info"):t("auth-comp")],1)},staticRenderFns:[]};var C={uploadImage:function(e){var t=this;return o()(s.a.mark(function r(){var a,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("image",e),t.prev=2,t.next=5,l.a.post("api/images",a);case 5:return n=t.sent,t.abrupt("return",n.data);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}},r,t,[[2,9]])}))()},getCategories:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.get("/api/orders/categories");case 3:return r=e.sent,e.abrupt("return",r.data);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},t,e,[[0,7]])}))()},getAllReviews:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.get("/api/reviews");case 3:return r=e.sent,e.abrupt("return",r.data);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},t,e,[[0,7]])}))()},createOrder:function(e){var t=this;return o()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_.checkTokens();case 3:return t.next=5,l.a.post("/api/orders/",e);case 5:return a=t.sent,t.abrupt("return",a.data);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},r,t,[[0,9]])}))()},getOrderDetails:function(e){var t=this;return o()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.checkTokens();case 2:return t.prev=2,t.next=5,l.a.get("/api/orders/"+e);case 5:return a=t.sent,t.abrupt("return",a.data);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}},r,t,[[2,9]])}))()},changeOrderStatus:function(e,t){var r=this;return o()(s.a.mark(function a(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_.checkTokens();case 2:return r.prev=2,r.next=5,l.a.put("/api/orders/"+e+"/status",t,{headers:{"Content-Type":"application/json"}});case 5:r.sent,r.next=11;break;case 8:throw r.prev=8,r.t0=r.catch(2),r.t0;case 11:case"end":return r.stop()}},a,r,[[2,8]])}))()},changePrice:function(e,t){var r=this;return o()(s.a.mark(function a(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_.checkTokens();case 2:return r.prev=2,r.next=5,l.a.put("/api/orders/"+e+"/price",t,{headers:{"Content-type":"application/json"}});case 5:r.sent,r.next=11;break;case 8:throw r.prev=8,r.t0=r.catch(2),r.t0;case 11:case"end":return r.stop()}},a,r,[[2,8]])}))()},getAllOrders:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.checkTokens();case 2:return e.prev=2,e.next=5,l.a.get("/api/orders");case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:case"end":return e.stop()}},t,e,[[2,9]])}))()},sendReview:function(e){var t=this;return o()(s.a.mark(function r(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.checkTokens();case 2:return t.prev=2,t.next=5,l.a.post("/api/reviews",e);case 5:t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(2),t.t0;case 10:case"end":return t.stop()}},r,t,[[2,7]])}))()},getClientOrders:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.checkTokens();case 2:return e.prev=2,e.next=5,l.a.get("/api/orders/my");case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:case"end":return e.stop()}},t,e,[[2,9]])}))()},updateUserProfile:function(e,t){var r=this;return o()(s.a.mark(function a(){var n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_.checkTokens();case 2:return r.prev=2,r.next=5,l.a.put("/api/users/"+e+"/profile",t);case 5:return n=r.sent,r.abrupt("return",n.data);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}},a,r,[[2,9]])}))()}},y={name:"head-bar",components:{"user-box":r("VU/8")(w,x,!1,function(e){r("S3rz")},"data-v-544cfafd",null).exports},data:function(){return{user:_.user,active_orders_num:0}},created:function(){p.$on("refresh-page",this.checkOrders),p.$on("user-sign-in",this.checkOrders),p.$on("user-sign-out",this.headBarSignOutListener)},destroyed:function(){p.$off("refresh-page",this.checkOrders),p.$off("user-sign-in",this.checkOrders),p.$off("user-sign-out",this.headBarSignOutListener)},methods:{headBarSignOutListener:function(){this.active_orders_num=0},checkOrders:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(_.userIsWorker()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,C.getAllOrders();case 5:r=t.sent,e.active_orders_num=r.filter(function(e){return 0==e.status}).length,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[2,9]])}))()}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",[a("md-toolbar",{staticClass:"md-dense md-primary",attrs:{"md-theme":"toolbar2"}},[a("div",{staticClass:"container"},[a("div",[a("router-link",{staticClass:"home-link",attrs:{to:"/"}},[a("img",{attrs:{src:r("7Otq")}}),e._v(" "),a("h1",{staticClass:"md-title"},[e._v("HeatDevices")])])],1),e._v(" "),a("nav",[a("router-link",{attrs:{tag:"md-button",to:"/"}},[e._v("Главная")]),e._v(" "),e.active_orders_num?a("md-badge",{staticClass:"md-primary md-square",attrs:{"md-position":"top","md-content":e.active_orders_num}},[a("router-link",{attrs:{tag:"md-button",to:"/orders"}},[e._v("Заказы")])],1):a("router-link",{attrs:{tag:"md-button",to:"/orders"}},[e._v("Заявки")]),e._v(" "),a("router-link",{attrs:{tag:"md-button",to:"/reviews"}},[e._v("Отзывы")])],1),e._v(" "),a("user-box")],1)])],1)},staticRenderFns:[]};var O={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"loading"},[this._v("Loading…")])},staticRenderFns:[]};var A={name:"App",components:{"head-bar":r("VU/8")(y,$,!1,function(e){r("yChZ")},"data-v-6df8ab61",null).exports,spinner:r("VU/8")({name:"spinner"},O,!1,function(e){r("U85u")},"data-v-7a15b7f6",null).exports},data:function(){return{global_loading:!1}},mounted:function(){p.$emit("refresh-page")},created:function(){p.$on("global-loading-start",this.loadingStartListener),p.$on("global-loading-finish",this.loadingFinishListener)},destroyed:function(){p.$off("global-loading-start",this.loadingStartListener),p.$off("global-loading-finish",this.loadingFinishListener)},methods:{loadingStartListener:function(){this.global_loading=!0},loadingFinishListener:function(){this.global_loading=!1}}},q={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this.global_loading?t("spinner"):this._e(),this._v(" "),t("head-bar"),this._v(" "),t("div",{staticClass:"content"},[t("router-view")],1)],1)},staticRenderFns:[]};var D=r("VU/8")(A,q,!1,function(e){r("FhiH")},null,null).exports,E=r("/ocq"),U={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("md-card",[t("md-card-header",[t("div",{staticClass:"md-title"},[this._v("Добро пожаловать!")])]),this._v(" "),t("md-card-content",[t("p",[this._v("Lorem ipsum dolor sit amet consectetur adipisicing elit. Maiores non, quo officia provident pariatur magnam fuga, in excepturi enim dolores omnis iste aperiam corrupti, dignissimos placeat amet ducimus. Veniam, voluptatum!")]),this._v(" "),t("p",[this._v("Nam officiis neque velit ipsa blanditiis sunt iure, reiciendis deleniti repellendus non minus laboriosam cumque sit necessitatibus veniam ipsum nesciunt, consequatur accusamus mollitia provident doloribus dolore enim labore! Quas, maxime?")]),this._v(" "),t("p",[this._v("Dicta veritatis alias magni quisquam, perspiciatis ratione recusandae quam. Ratione id, nesciunt quas optio voluptatum exercitationem vel. Accusamus itaque fuga in corporis! Tenetur necessitatibus soluta labore ipsam harum magnam dolorem!")])])],1)],1)},staticRenderFns:[]};var N=r("VU/8")({name:"home-page"},U,!1,function(e){r("4XAy")},"data-v-1dc35650",null).exports,R={name:"worker-orders",data:function(){return{user:_.user,orders:[],categories:[],error:null,loading:!1,snackbar_message:"",show_snackbar:!1}},created:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p.$on("user-sign-in",e.loadOrders),e.user.is_authenticated){t.next=4;break}return e.showAuthError(),t.abrupt("return");case 4:return t.next=7,e.loadOrders();case 7:case"end":return t.stop()}},t,e)}))()},destroyed:function(){p.$off("user-sign-in",this.loadOrders)},computed:{sortedOrders:function(){return this.orders.sort(function(e,t){return e.status<t.status?-1:e.status>t.status?1:0})}},methods:{formatDate:function(e){new Date;return new Date(e).toLocaleString("ru",{month:"long",day:"numeric",year:"numeric"})},statusColour:function(e){return{color:{0:"black",1:"black",2:"blue",3:"blue",4:"green",5:"red",6:"red"}[e]}},statusName:function(e){return{0:"Ожидание подтверждения",1:"Ожидание диагностики",2:"Диагностика",3:"Выполняются ремонтные работы",4:"Завершен",5:"Отменен",6:"Отменен"}[e]},categoryName:function(e){return this.categories.find(function(t){return t.id==e}).description},goToOrder:function(e){this.$router.push("orders/"+e)},showAuthError:function(){this.error={title:"Необходима авторизация",description:"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации.",link:"/sign_up",link_text:"Зарегистрироваться",icon:"lock"}},loadOrders:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.error=null,e.loading=!0,t.next=5,C.getAllOrders();case 5:return e.orders=t.sent,t.next=8,C.getCategories();case 8:e.categories=t.sent,t.next=27;break;case 11:if(t.prev=11,t.t0=t.catch(0),502!==(r=t.t0.response.status)&&504!==r){t.next=19;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,e.error={title:"Ошибка доступа к серверу",description:"Возникла ошибка при подключении к серверу. Вы можете обновить страницу или вернуться на главную.",link:"/",link_text:"На главную",icon:"error"},t.abrupt("return");case 19:if(401!==r&&403!==r){t.next=24;break}return e.snackbar_message="Ошибка авторизации",e.show_snackbar=!0,e.showAuthError(),t.abrupt("return");case 24:if(404!==r){t.next=27;break}return e.error={title:"Заявки отсутствуют.",description:"На данный момент заявки остутсвуют. Вы можете зайти на данную страницу позже.",link:"/",link_text:"На главную",icon:"search"},t.abrupt("return");case 27:return t.prev=27,e.loading=!1,t.finish(27);case 30:case"end":return t.stop()}},t,e,[[0,11,27,30]])}))()}}},L={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],attrs:{"md-icon":e.error.icon,"md-label":e.error.title,"md-description":e.error.description}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push(e.error.link)}}},[e._v(e._s(e.error.link_text))])],1):r("div",[e.loading?r("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-stroke":3,"md-mode":"indeterminate"}}):e.orders?r("div",{staticClass:"orders-container"},e._l(e.sortedOrders,function(t){return r("md-card",{key:t.id,staticClass:"order-card"},[r("md-card-header",{staticStyle:{"{margin-left":"0"}},[r("md-avatar",[r("img",{attrs:{src:t.client.avatar,alt:"client"}})]),e._v(" "),r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v(e._s(e.categoryName(t.category)))]),e._v(" "),r("div",{staticClass:"md-subhead"},[e._v("\r\n                        Заказчик: \r\n                        "),r("span",{staticClass:"link"},[e._v("\r\n                            "+e._s(t.client.name+" "+t.client.surname)+"\r\n                        ")])])])],1),e._v(" "),r("md-divider"),e._v(" "),r("md-card-content",[r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Дата оформления: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[r("md-icon",[e._v("date_range")]),e._v("\r\n                            "+e._s(e.formatDate(t.beginning_time))+"\r\n                        ")],1)]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Статус: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item",style:e.statusColour(t.status)},[e._v("\r\n                            "+e._s(e.statusName(t.status))+"\r\n                        ")])]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Адрес: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[e._v("\r\n                            "+e._s(t.address)+"\r\n                        ")])]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Контакнтый номер: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[r("md-icon",[e._v("phone")]),e._v("\r\n                            "+e._s(t.client.phone)+"\r\n                        ")],1)])]),e._v(" "),r("md-card-actions",[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(r){e.goToOrder(t.id)}}},[e._v("Перейти к заявке")])],1)],1)})):e._e()],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var S={name:"orders",components:{"worker-orders":r("VU/8")(R,L,!1,function(e){r("Sp7h")},"data-v-715c8cb4",null).exports},data:function(){return{user:_.user}},computed:{isWorker:function(){return _.userIsWorker()}}},I={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.user.is_authenticated?r("div",[e.isWorker?r("worker-orders"):r("md-empty-state",{attrs:{"md-icon":"assignment","md-label":"Оформите заявку на ремонт","md-description":"Заполните форму заявки, и мы поможем Вам отремонтировать Вашу технику."}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push("/orders/create")}}},[e._v("Оставить заявку")])],1)],1):r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:!e.user.is_authenticated,expression:"!user.is_authenticated"}],attrs:{"md-icon":"lock","md-label":"Необходима авторизация","md-description":"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации."}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push("/sign_up")}}},[e._v("Зарегистрироваться")])],1)],1)},staticRenderFns:[]};var P=r("VU/8")(S,I,!1,function(e){r("d0a1")},"data-v-59d644be",null).exports,F={name:"create-order",data:function(){return{order:{address:"",category:null,visit_date:null},user:_.user,snackbar_message:"",order_id:-1,show_snackbar:!1,show_dialog:!1,loading:!1,categories:[]}},created:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return p.$on("user-sign-out",e.signOutListener),t.next=3,e.loadCategories();case 3:case"end":return t.stop()}},t,e)}))()},destroyed:function(){p.$off("user-sign-out",this.signOutListener)},methods:{signOutListener:function(){this.$router.push("/")},onDialogClosed:function(){this.$router.push("/orders/"+this.order_id)},loadCategories:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,C.getCategories();case 4:e.categories=t.sent,t.next=14;break;case 7:if(t.prev=7,t.t0=t.catch(0),502!==(r=t.t0.response.status)&&504!==r){t.next=14;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 14:return t.prev=14,e.loading=!1,t.finish(14);case 17:case"end":return t.stop()}},t,e,[[0,7,14,17]])}))()},createOrder:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(t.t1=!t.sent,t.t1){t.next=5;break}t.t1=null==e.order.category;case 5:if(t.t0=t.t1,t.t0){t.next=8;break}t.t0=null==e.order.visit_date;case 8:if(!t.t0){t.next=12;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 12:return t.prev=12,p.$emit("global-loading-start"),t.next=16,C.createOrder(e.order);case 16:r=t.sent,e.order_id=r.id,e.show_dialog=!0,t.next=35;break;case 21:if(t.prev=21,t.t2=t.catch(12),502!==status&&504!==status){t.next=27;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 27:if(401!==status&&403!==status){t.next=31;break}return e.snackbar_message="Ошибка авторизации",e.show_snackbar=!0,t.abrupt("return");case 31:if(400!==status){t.next=35;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 35:return t.prev=35,p.$emit("global-loading-finish"),t.finish(35);case 38:case"end":return t.stop()}},t,e,[[12,21,35,38]])}))()}}},T={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.loading?r("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-stroke":3,"md-mode":"indeterminate"}}):e.user.is_authenticated?r("md-card",{staticClass:"order-card"},[r("md-card-header",[r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v("Оформление заявки на ремонт")])])],1),e._v(" "),r("md-card-content",[r("form",{staticClass:"order-form",attrs:{novalidate:""}},[r("md-field",{class:{"md-invalid":e.errors.has("category")}},[r("md-select",{attrs:{name:"category",placeholder:"Модель оборудования",required:""},model:{value:e.order.category,callback:function(t){e.$set(e.order,"category",t)},expression:"order.category"}},e._l(e.categories,function(t){return r("md-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.description))])}))],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("address")}},[r("label",[e._v("Адрес")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|min:5|max:75",expression:"'required|min:5|max:75'"}],attrs:{required:"",maxlength:"75",name:"address","data-vv-as":"адрес","data-vv-name":"address"},model:{value:e.order.address,callback:function(t){e.$set(e.order,"address",t)},expression:"order.address"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("address")))])],1),e._v(" "),r("md-datepicker",{attrs:{"md-immediately":""},model:{value:e.order.visit_date,callback:function(t){e.$set(e.order,"visit_date",t)},expression:"order.visit_date"}},[r("label",[e._v("Дата проведения дианостики")])])],1),e._v(" "),r("md-card-actions",[r("md-button",{on:{click:function(t){e.$router.push("/orders")}}},[e._v("Отмена")]),e._v(" "),r("md-button",{staticClass:"md-primary md-raised",on:{click:e.createOrder}},[e._v("Ок")])],1)],1)],1):r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:!e.user.is_authenticated,expression:"!user.is_authenticated"}],attrs:{"md-icon":"lock","md-label":"Необходима авторизация","md-description":"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации."}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push("/sign_up")}}},[e._v("Зарегистрироваться")])],1),e._v(" "),r("md-dialog-alert",{attrs:{"md-content":"Заявка успешно оставлена. Вы будете перенаправлены к странице заявки.","md-confirm-text":"Ок","md-active":e.show_dialog},on:{"md-closed":e.onDialogClosed,"update:mdActive":function(t){e.show_dialog=t}}}),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var V=r("VU/8")(F,T,!1,function(e){r("vmyf")},"data-v-5a2063e8",null).exports,W={name:"order-detail",data:function(){return{user:_.user,order:null,categories:[],error:null,loading:!1,show_snackbar:!1,snackbar_message:"",show_decline_dialog:!1,show_accept_dialog:!1,show_price_dialog:!1,new_status:0}},created:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p.$on("user-sign-in",e.loadOrderDetails),p.$on("user-sign-out",e.signOutListener),e.user.is_authenticated){t.next=5;break}return e.showAuthError(),t.abrupt("return");case 5:return t.next=8,e.loadOrderDetails();case 8:case"end":return t.stop()}},t,e)}))()},destroyed:function(){p.$off("user-sign-in",this.loadOrderDetails),p.$off("user-sign-out",this.signOutListener)},computed:{acceptText:function(){return{0:"Подтвердить заявку",1:"Начать диагностику",2:"Начать выполнение работ",3:"Завершить заказ"}[this.order.status]},canReview:function(){return this.order.client.id===this.user.id&&4===this.order.status},canChangePrice:function(){return _.userIsWorker()&&[2,3].includes(this.order.status)},canAccept:function(){return _.userIsWorker()&&[0,1,2,3].includes(this.order.status)},canDecline:function(){return!(!_.userIsClient()||![0,1].includes(this.order.status))||!(!_.userIsWorker()||![0,1,2,3].includes(this.order.status))},statusColour:function(){return{color:{0:"black",1:"black",2:"blue",3:"blue",4:"green",5:"red",6:"red"}[this.order.status]}},statusName:function(){return{0:"Ожидание подтверждения",1:"Ожидание диагностики",2:"Диагностика",3:"Выполняются ремонтные работы",4:"Завершен",5:"Отменен",6:"Отменен"}[this.order.status]}},methods:{signOutListener:function(){this.$router.push("/")},reviewHandler:function(){this.$router.push("/orders/"+this.order.id+"/review")},acceptHandler:function(){this.order.status in[0,1,2,3]&&(this.new_status=this.order.status+1),this.show_accept_dialog=!0},declineHandler:function(){_.userIsWorker()&&(this.new_status=6),_.userIsClient()&&(this.new_status=5),this.show_decline_dialog=!0},priceHandler:function(){this.show_price_dialog=!0},formatDate:function(e){new Date;return new Date(e).toLocaleString("ru",{month:"long",day:"numeric",year:"numeric"})},categoryName:function(e){return this.categories.find(function(t){return t.id==e}).description},showAuthError:function(){this.error={title:"Необходима авторизация",description:"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации.",link:"/sign_up",link_text:"Зарегистрироваться",icon:"lock"}},handleStatus:function(e){return 502===e||504===e?(this.snackbar_message="Ошибка доступа к серверу",void(this.show_snackbar=!0)):401===e||403===e?(this.snackbar_message="Ошибка авторизации",void(this.show_snackbar=!0)):404===e?(this.snackbar_message="Заявка не найдена",void(this.show_snackbar=!0)):400===e?(this.snackbar_message="Неверный статус заявки",void(this.show_snackbar=!0)):void 0},changePrice:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,p.$emit("global-loading-start"),t.next=4,C.changePrice(e.order.id,e.order.price);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),r=t.t0.response.status,e.handleStatus(r);case 10:return t.prev=10,p.$emit("global-loading-finish"),t.finish(10);case 13:case"end":return t.stop()}},t,e,[[0,6,10,13]])}))()},changeStatus:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,p.$emit("global-loading-start"),t.next=4,C.changeOrderStatus(e.order.id,e.new_status);case 4:e.order.status=e.new_status,t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),r=t.t0.response.status,e.handleStatus(r);case 11:return t.prev=11,p.$emit("global-loading-finish"),t.finish(11);case 14:case"end":return t.stop()}},t,e,[[0,7,11,14]])}))()},loadOrderDetails:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.error=null,e.loading=!0,t.next=5,C.getOrderDetails(e.$route.params.id);case 5:return e.order=t.sent,t.next=8,C.getCategories();case 8:e.categories=t.sent,t.next=27;break;case 11:if(t.prev=11,t.t0=t.catch(0),502!==(r=t.t0.response.status)&&504!==r){t.next=19;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,e.error={title:"Ошибка доступа к серверу",description:"Возникла ошибка при подключении к серверу. Вы можете обновить страницу или вернуться на главную.",link:"/",link_text:"На главную",icon:"error"},t.abrupt("return");case 19:if(401!==r&&403!==r){t.next=24;break}return e.snackbar_message="Ошибка авторизации",e.show_snackbar=!0,e.showAuthError(),t.abrupt("return");case 24:if(404!==r){t.next=27;break}return e.error={title:"Информация о заявке не найдена",description:"Информация о данной заявке не была найдена. Возможно, вы ошиблись страницей, или заявка была удалена.",link:"/orders",link_text:"К заявкам",icon:"search"},t.abrupt("return");case 27:return t.prev=27,e.loading=!1,t.finish(27);case 30:case"end":return t.stop()}},t,e,[[0,11,27,30]])}))()}}},H={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],attrs:{"md-icon":e.error.icon,"md-label":e.error.title,"md-description":e.error.description}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push(e.error.link)}}},[e._v(e._s(e.error.link_text))])],1):r("div",[e.loading?r("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-stroke":3,"md-mode":"indeterminate"}}):e.order?r("div",[r("md-card",{staticClass:"order-details-card"},[r("md-card-header",[r("div",{staticClass:"md-title"},[e._v("Информация о заявке")])]),e._v(" "),r("md-card-content",[r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Заказчик: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[e._v("\r\n                            "+e._s(e.order.client.name)+" "+e._s(e.order.client.surname)+"\r\n                            "),r("br"),e._v(" "),r("md-icon",[e._v("phone")]),e._v(e._s(e.order.client.phone)+"\r\n                            "),r("br"),e._v("\r\n                            "+e._s(e.order.address)+"\r\n                        ")],1)]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Модель оборудования: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[e._v("\r\n                            "+e._s(e.categoryName(e.order.category))+"\r\n                        ")])]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Дата проведения диагностики: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[r("md-icon",[e._v("date_range")]),e._v("\r\n                            "+e._s(e.formatDate(e.order.visit_time))+"\r\n                        ")],1)]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Дата оформления заявки: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[r("md-icon",[e._v("date_range")]),e._v("\r\n                            "+e._s(e.formatDate(e.order.beginning_time))+"\r\n                        ")],1)]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Статус: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item",style:e.statusColour},[e._v("\r\n                            "+e._s(e.statusName)+"\r\n                        ")])]),e._v(" "),r("md-divider"),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Стоимость диагностики: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[e._v("\r\n                            "+e._s(e.order.diagnostic_price)+"\r\n                        ")])]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Стоимость работ: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[e._v("\r\n                            "+e._s(e.order.price)+"\r\n                        ")])])],1),e._v(" "),r("md-card-actions",[e.canReview?r("md-button",{staticClass:"md-raised md-primary",on:{click:e.reviewHandler}},[e._v("Оставить отзыв")]):e._e(),e._v(" "),e.canDecline?r("md-button",{staticClass:"md-raised md-accent",on:{click:e.declineHandler}},[e._v("Отмена")]):e._e(),e._v(" "),e.canAccept?r("md-button",{staticClass:"md-raised md-primary",on:{click:e.acceptHandler}},[e._v(e._s(e.acceptText))]):e._e(),e._v(" "),r("md-button",{directives:[{name:"show",rawName:"v-show",value:e.canChangePrice,expression:"canChangePrice"}],staticClass:"md-raised md-primary",on:{click:e.priceHandler}},[e._v("стоимость работ")])],1)],1),e._v(" "),r("md-dialog-prompt",{attrs:{"md-active":e.show_price_dialog,type:"number","md-title":"Введите стоимость работ.","md-confirm-text":"Ок","md-cancel-text":"Отмена"},on:{"update:mdActive":function(t){e.show_price_dialog=t},"md-confirm":e.changePrice},model:{value:e.order.price,callback:function(t){e.$set(e.order,"price",t)},expression:"order.price"}})],1):e._e()],1),e._v(" "),r("md-dialog-confirm",{attrs:{"md-active":e.show_decline_dialog,"md-title":"Вы действительно хотите отменить заявку?","md-content":"Данные действие необратимо.","md-confirm-text":"Да","md-cancel-text":"Нет"},on:{"update:mdActive":function(t){e.show_decline_dialog=t},"md-confirm":e.changeStatus}}),e._v(" "),r("md-dialog-confirm",{attrs:{"md-active":e.show_accept_dialog,"md-title":"Вы действительно хотите продолжить?","md-confirm-text":"Да","md-cancel-text":"Нет"},on:{"update:mdActive":function(t){e.show_accept_dialog=t},"md-confirm":e.changeStatus}}),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var z=r("VU/8")(W,H,!1,function(e){r("+GAs")},"data-v-a2d876ec",null).exports,B={name:"client-orders",data:function(){return{user:_.user,orders:[],categories:[],error:null,loading:!1,snackbar_message:"",show_snackbar:!1}},created:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p.$on("user-sign-in",e.loadOrders),p.$on("user-sign-out",e.signOutClientOrdersListener),e.user.is_authenticated){t.next=5;break}return e.showAuthError(),t.abrupt("return");case 5:return t.next=8,e.loadOrders();case 8:case"end":return t.stop()}},t,e)}))()},destroyed:function(){p.$off("user-sign-out",this.signOutClientOrdersListener),p.$off("user-sign-in",this.loadOrders)},computed:{sortedOrders:function(){return this.orders.sort(function(e,t){return e.status<t.status?-1:e.status>t.status?1:0})}},methods:{signOutClientOrdersListener:function(){this.$router.push("/")},formatDate:function(e){new Date;return new Date(e).toLocaleString("ru",{month:"long",day:"numeric",year:"numeric"})},statusColour:function(e){return{color:{0:"black",1:"black",2:"blue",3:"blue",4:"green",5:"red",6:"red"}[e]}},statusName:function(e){return{0:"Ожидание подтверждения",1:"Ожидание диагностики",2:"Диагностика",3:"Выполняются ремонтные работы",4:"Завершен",5:"Отменен",6:"Отменен"}[e]},categoryName:function(e){return this.categories.find(function(t){return t.id==e}).description},goToOrder:function(e){this.$router.push("orders/"+e)},showAuthError:function(){this.error={title:"Необходима авторизация",description:"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации.",link:"/sign_up",link_text:"Зарегистрироваться",icon:"lock"}},loadOrders:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.error=null,e.loading=!0,t.next=5,C.getClientOrders();case 5:return e.orders=t.sent,t.next=8,C.getCategories();case 8:e.categories=t.sent,t.next=27;break;case 11:if(t.prev=11,t.t0=t.catch(0),502!==(r=t.t0.response.status)&&504!==r){t.next=19;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,e.error={title:"Ошибка доступа к серверу",description:"Возникла ошибка при подключении к серверу. Вы можете обновить страницу или вернуться на главную.",link:"/",link_text:"На главную",icon:"error"},t.abrupt("return");case 19:if(401!==r&&403!==r){t.next=24;break}return e.snackbar_message="Ошибка авторизации",e.show_snackbar=!0,e.showAuthError(),t.abrupt("return");case 24:if(404!==r){t.next=27;break}return e.error={title:"Заявки отсутствуют.",description:"На данный момент заявки остутсвуют. Вы можете зайти на данную страницу позже.",link:"/",link_text:"На главную",icon:"search"},t.abrupt("return");case 27:return t.prev=27,e.loading=!1,t.finish(27);case 30:case"end":return t.stop()}},t,e,[[0,11,27,30]])}))()}}},j={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],attrs:{"md-icon":e.error.icon,"md-label":e.error.title,"md-description":e.error.description}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push(e.error.link)}}},[e._v(e._s(e.error.link_text))])],1):r("div",[e.loading?r("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-stroke":3,"md-mode":"indeterminate"}}):e.orders?r("div",{staticClass:"orders-container"},e._l(e.sortedOrders,function(t){return r("md-card",{key:t.id,staticClass:"order-card"},[r("md-card-header",{staticStyle:{"{margin-left":"0"}},[r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v(e._s(e.categoryName(t.category)))])])],1),e._v(" "),r("md-divider"),e._v(" "),r("md-card-content",[r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Дата оформления: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[r("md-icon",[e._v("date_range")]),e._v("\r\n                            "+e._s(e.formatDate(t.beginning_time))+"\r\n                        ")],1)]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Дата диагностики: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[r("md-icon",[e._v("date_range")]),e._v("\r\n                            "+e._s(e.formatDate(t.visit_time))+"\r\n                        ")],1)]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Статус: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item",style:e.statusColour(t.status)},[e._v("\r\n                            "+e._s(e.statusName(t.status))+"\r\n                        ")])]),e._v(" "),r("div",{staticClass:"flex-list"},[r("div",{staticClass:"md-subheading left-item"},[e._v("\r\n                            Адрес: \r\n                        ")]),e._v(" "),r("div",{staticClass:"md-body-2 right-item"},[e._v("\r\n                            "+e._s(t.address)+"\r\n                        ")])])]),e._v(" "),r("md-card-actions",[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(r){e.goToOrder(t.id)}}},[e._v("Перейти к заявке")])],1)],1)})):e._e()],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var M=r("VU/8")(B,j,!1,function(e){r("6yFA")},"data-v-e72c8f76",null).exports,X={name:"sign-up",data:function(){return{input:{login:"",password:"",name:"",surname:"",phone:"",avatar:""},snackbar_message:"",show_snackbar:!1,show_dialog:!1,password_confirm:"",file:null,image_preview:"https://www.drupal.org/files/issues/default-avatar.png"}},created:function(){p.$on("user-sign-in",this.userSignInListener)},destroyed:function(){p.$off("user-sign-in",this.userSignInListener)},methods:{userSignInListener:function(){this.$router.push("/")},onDialogClosed:function(){this.$router.push("/")},onFileChange:function(e){var t=this;this.file=document.getElementById("avatar").files[0];new Image;var r=new FileReader;r.onload=function(e){t.image_preview=e.target.result},r.readAsDataURL(this.file)},signUp:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(t.sent){t.next=6;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 6:if(p.$emit("global-loading-start"),t.prev=7,null===e.file){t.next=12;break}return t.next=11,C.uploadImage(e.file);case 11:e.input.avatar=t.sent;case 12:return t.next=14,_.signUp(e.input);case 14:e.show_dialog=!0,t.next=27;break;case 17:if(t.prev=17,t.t0=t.catch(7),502!==status&&504!==status){t.next=23;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 23:if(400!==t.t0.response.status){t.next=27;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 27:return t.prev=27,p.$emit("global-loading-finish"),t.finish(27);case 30:case"end":return t.stop()}},t,e,[[7,17,27,30]])}))()}}},G={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("md-card",[r("md-card-header",[r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v("Регистрация")])])],1),e._v(" "),r("md-card-content",{staticClass:"container"},[r("div",{staticClass:"left"},[r("form",{staticClass:"sign-up-form",attrs:{novalidate:""}},[r("md-field",{class:{"md-invalid":e.errors.has("login")}},[r("label",[e._v("Логин")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_num|min:3|max:15",expression:"'required|alpha_num|min:3|max:15'"}],attrs:{required:"",maxlength:"15",name:"login","data-vv-as":"логин","data-vv-name":"login"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signUp(t):null}},model:{value:e.input.login,callback:function(t){e.$set(e.input,"login",t)},expression:"input.login"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("login")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("password")},attrs:{"md-has-password":""}},[r("label",[e._v("Пароль")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_dash|min:5|max:20",expression:"'required|alpha_dash|min:5|max:20'"}],attrs:{required:"",type:"password",name:"password","data-vv-as":"пароль","data-vv-name":"password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signUp(t):null}},model:{value:e.input.password,callback:function(t){e.$set(e.input,"password",t)},expression:"input.password"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("password")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("password_confirm")},attrs:{"md-has-password":""}},[r("label",[e._v("Подтверждение пароля")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"confirmed:password",expression:"'confirmed:password'"}],attrs:{required:"",type:"password",name:"password_confirm","data-vv-as":"пароль","data-vv-name":"password_confirm"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signUp(t):null}},model:{value:e.password_confirm,callback:function(t){e.password_confirm=t},expression:"password_confirm"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("password_confirm")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("name")}},[r("label",[e._v("Имя")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_spaces|min:3|max:15",expression:"'required|alpha_spaces|min:3|max:15'"}],attrs:{required:"",maxlength:"15",name:"name","data-vv-as":"имя","data-vv-name":"name"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signUp(t):null}},model:{value:e.input.name,callback:function(t){e.$set(e.input,"name",t)},expression:"input.name"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("name")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("surname")}},[r("label",[e._v("Фамилия")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_spaces|min:3|max:15",expression:"'required|alpha_spaces|min:3|max:15'"}],attrs:{required:"",maxlength:"15",name:"surname","data-vv-as":"фамилия","data-vv-name":"surname"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signUp(t):null}},model:{value:e.input.surname,callback:function(t){e.$set(e.input,"surname",t)},expression:"input.surname"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("surname")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("phone")}},[r("md-icon",[e._v("phone")]),e._v(" "),r("label",[e._v("Номер телефона")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"regex:^[7-8][0-9]{10}$",expression:"'regex:^[7-8][0-9]{10}$'"}],attrs:{required:"",maxlength:"11",name:"phone","data-vv-as":"номер телефона","data-vv-name":"phone"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.signUp(t):null}},model:{value:e.input.phone,callback:function(t){e.$set(e.input,"phone",t)},expression:"input.phone"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("phone")))])],1),e._v(" "),r("md-field",{attrs:{"md-clearable":""}},[r("md-icon",[e._v("insert_photo")]),e._v(" "),r("label",[e._v("Аватар")]),e._v(" "),r("md-file",{attrs:{id:"avatar",type:"file",accept:"image/*"},on:{input:e.onFileChange}})],1)],1)]),e._v(" "),r("md-card-media",{staticClass:"right",attrs:{"md-medium":"","md-ratio":"4:3"}},[r("img",{attrs:{src:e.image_preview,alt:"Avatar"}})])],1),e._v(" "),r("md-card-actions",[r("md-button",{on:{click:function(t){e.$router.push("/")}}},[e._v("Отмена")]),e._v(" "),r("md-button",{staticClass:"md-raised md-primary",on:{click:e.signUp}},[e._v("Регистрация")])],1)],1),e._v(" "),r("md-dialog-alert",{attrs:{"md-content":"Вы были успешно зарегистрированы.","md-confirm-text":"Ок","md-active":e.show_dialog},on:{"md-closed":e.onDialogClosed,"update:mdActive":function(t){e.show_dialog=t}}}),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var Q=r("VU/8")(X,G,!1,function(e){r("x10d")},"data-v-0221baf3",null).exports,Z={name:"edit-user",props:{user:Object},data:function(){return{input:{name:"",surname:"",phone:"",avatar:""},snackbar_message:"",show_snackbar:!1,file:null}},created:function(){this.input.name=this.user.profile.name,this.input.surname=this.user.profile.surname,this.input.phone=this.user.profile.phone,this.input.avatar=this.user.profile.avatar},methods:{onFileChange:function(e){this.file=document.getElementById("image").files[0]},leavePage:function(){this.$emit("page-leave")},editProfile:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(t.sent){t.next=6;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 6:if(!e.file){t.next=10;break}return t.next=9,C.uploadImage(e.file);case 9:e.input.avatar=t.sent;case 10:return t.prev=10,p.$emit("global-loading-start"),t.next=14,C.updateUserProfile(e.user.id,e.input);case 14:t.sent,e.$emit("profile-edited",e.input),e.leavePage(),t.next=38;break;case 19:if(t.prev=19,t.t0=t.catch(10),502!==(r=t.t0.response.status)&&504!==r){t.next=26;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 26:if(401!==r&&403!==r){t.next=30;break}return e.snackbar_message="У вас недостаточно прав для совершения данного действия",e.show_snackbar=!0,t.abrupt("return");case 30:if(404!==r){t.next=34;break}return e.snackbar_message="Ресурс не найден. Перезагрузите страницу",e.show_snackbar=!0,t.abrupt("return");case 34:if(400!==r){t.next=38;break}return e.snackbar_message="Введите данные корректно!",e.show_snackbar=!0,t.abrupt("return");case 38:return t.prev=38,p.$emit("global-loading-finish"),t.finish(38);case 41:case"end":return t.stop()}},t,e,[[10,19,38,41]])}))()}}},J={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("md-card",{staticClass:"edit-profile-card"},[r("md-card-header",[r("div",{staticClass:"md-title"},[e._v("Изменение данных профиля")])]),e._v(" "),r("md-card-content",[r("form",{staticClass:"user-form",attrs:{novalidate:""},on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.submit(t)}}},[r("md-field",{class:{"md-invalid":e.errors.has("name")}},[r("label",[e._v("Имя")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_spaces|min:3|max:15",expression:"'required|alpha_spaces|min:3|max:15'"}],attrs:{required:"",maxlength:"15",name:"name","data-vv-as":"имя","data-vv-name":"name"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.editProfile(t):null}},model:{value:e.input.name,callback:function(t){e.$set(e.input,"name",t)},expression:"input.name"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("name")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("surname")}},[r("label",[e._v("Фамилия")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_spaces|min:3|max:15",expression:"'required|alpha_spaces|min:3|max:15'"}],attrs:{required:"",maxlength:"15",name:"surname","data-vv-as":"фамилия","data-vv-name":"surname"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.editProfile(t):null}},model:{value:e.input.surname,callback:function(t){e.$set(e.input,"surname",t)},expression:"input.surname"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("surname")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("phone")}},[r("md-icon",[e._v("phone")]),e._v(" "),r("label",[e._v("Номер телефона")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"regex:^[7-8][0-9]{10}$",expression:"'regex:^[7-8][0-9]{10}$'"}],attrs:{required:"",maxlength:"11",name:"phone","data-vv-as":"номер телефона","data-vv-name":"phone"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.editProfile(t):null}},model:{value:e.input.phone,callback:function(t){e.$set(e.input,"phone",t)},expression:"input.phone"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("phone")))])],1),e._v(" "),r("md-field",{attrs:{"md-clearable":""}},[r("label",[e._v("Аватар")]),e._v(" "),r("md-file",{attrs:{id:"image",type:"file",accept:"image/*"},on:{input:e.onFileChange}})],1)],1)]),e._v(" "),r("md-card-actions",[r("md-button",{staticClass:"md-primary",on:{click:e.leavePage}},[e._v("Отмена")]),e._v(" "),r("md-button",{staticClass:"md-primary md-raised",on:{click:e.editProfile}},[e._v("Сохранить")])],1)],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var K=r("VU/8")(Z,J,!1,function(e){r("iWm7")},"data-v-739e281c",null).exports,Y={name:"change-password",props:{user:Object},data:function(){return{input:{old_password:"",new_password:""},password_confirm:"",snackbar_message:"",show_snackbar:!1}},methods:{leavePage:function(){this.$emit("page-leave")},changePassword:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(t.sent){t.next=6;break}return e.snackbar_message="Введите данные корректно",e.show_snackbar=!0,t.abrupt("return");case 6:return t.prev=6,p.$emit("global-loading-start"),t.next=10,_.changePassword(e.user.id,e.input);case 10:e.$emit("password-changed"),e.leavePage(),t.next=32;break;case 14:if(t.prev=14,t.t0=t.catch(6),502!==status&&504!==status){t.next=20;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 20:if(401!==status&&403!==status){t.next=24;break}return e.snackbar_message="У вас недостаточно прав для совершения данного действия",e.show_snackbar=!0,t.abrupt("return");case 24:if(404!==status){t.next=28;break}return e.snackbar_message="Ресурс не найден. Перезагрузите страницу",e.show_snackbar=!0,t.abrupt("return");case 28:if(400!==status){t.next=32;break}return e.snackbar_message="Введите данные корректно!",e.show_snackbar=!0,t.abrupt("return");case 32:return t.prev=32,p.$emit("global-loading-finish"),t.finish(32);case 35:case"end":return t.stop()}},t,e,[[6,14,32,35]])}))()}}},ee={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("md-card",{staticClass:"password-card"},[r("md-card-header",[r("div",{staticClass:"md-title"},[e._v("Смена пароля")])]),e._v(" "),r("md-card-content",[r("form",{staticClass:"user-form",attrs:{novalidate:""},on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.submit(t)}}},[r("md-field",{class:{"md-invalid":e.errors.has("old_password")},attrs:{"md-has-password":""}},[r("label",[e._v("Старый пароль")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_dash|min:5|max:20",expression:"'required|alpha_dash|min:5|max:20'"}],attrs:{required:"",type:"password",name:"old_password","data-vv-as":"пароль","data-vv-name":"old_password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.changePassword(t):null}},model:{value:e.input.old_password,callback:function(t){e.$set(e.input,"old_password",t)},expression:"input.old_password"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("old_password")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("new_password")},attrs:{"md-has-password":""}},[r("label",[e._v("Новый пароль")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_dash|min:5|max:20",expression:"'required|alpha_dash|min:5|max:20'"}],attrs:{required:"",type:"password",name:"new_password","data-vv-as":"новый пароль","data-vv-name":"new_password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.changePassword(t):null}},model:{value:e.input.new_password,callback:function(t){e.$set(e.input,"new_password",t)},expression:"input.new_password"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("new_password")))])],1),e._v(" "),r("md-field",{class:{"md-invalid":e.errors.has("password_confirm")},attrs:{"md-has-password":""}},[r("label",[e._v("Подтверждение пароля")]),e._v(" "),r("md-input",{directives:[{name:"validate",rawName:"v-validate",value:"confirmed:new_password",expression:"'confirmed:new_password'"}],attrs:{required:"",type:"password",name:"password_confirm","data-vv-as":"пароль","data-vv-name":"password_confirm"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.changePassword(t):null}},model:{value:e.password_confirm,callback:function(t){e.password_confirm=t},expression:"password_confirm"}}),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("password_confirm")))])],1)],1)]),e._v(" "),r("md-card-actions",[r("md-button",{staticClass:"md-primary",on:{click:e.leavePage}},[e._v("Отмена")]),e._v(" "),r("md-button",{staticClass:"md-primary md-raised",on:{click:e.changePassword}},[e._v("Сохранить")])],1)],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var te={name:"profile",components:{"edit-user":K,"change-password":r("VU/8")(Y,ee,!1,function(e){r("9pTX")},"data-v-38e943f8",null).exports},data:function(){return{user:_.user,loading:!1,edit_page:!1,show_dialog:!1,change_password:!1}},metaInfo:function(){return{title:this.user.name}},created:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:p.$on("user-sign-out",e.signOutProfileListening);case 1:case"end":return t.stop()}},t,e)}))()},destroyed:function(){p.$off("user-sign-out",this.signOutProfileListening)},computed:{userRoles:function(){if(!this.user.roles)return"";var e={admin:"администратор",worker:"сотрудник",client:"клиент",user:"пользователь"};return this.user.roles.map(function(t){return e[t]}).join(", ")}},methods:{signOutProfileListening:function(){this.$router.push("/")},profileEditedListener:function(e){this.user.profile=e},passwordChangedListener:function(){this.show_dialog=!0}}},re={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.user.is_authenticated?r("div",[e.loading?r("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-stroke":3,"md-mode":"indeterminate"}}):e.edit_page||e.change_password?e.edit_page?r("edit-user",{attrs:{user:e.user},on:{"page-leave":function(t){e.edit_page=!1},"profile-edited":e.profileEditedListener}}):r("change-password",{attrs:{user:e.user},on:{"page-leave":function(t){e.change_password=!1},"password-changed":e.passwordChangedListener}}):r("md-card",{staticClass:"profile-card"},[r("md-card-header",[r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v(e._s(e.user.profile.name)+" \r\n                        "+e._s(e.user.profile.surname)+"\r\n                        "),r("md-menu",{attrs:{"md-size":"small","md-direction":"bottom-start"}},[r("md-menu-content",[r("md-menu-item",{on:{click:function(t){e.edit_page=!0}}},[r("span",[e._v("Изменить данные")]),e._v(" "),r("md-icon",{staticStyle:{"margin-right":"0"}},[e._v("edit")])],1),e._v(" "),r("md-menu-item",{on:{click:function(t){e.change_password=!0}}},[e._v("\r\n                                    Смена пароля\r\n                                    "),r("md-icon",{staticStyle:{"margin-right":"0"}},[e._v("edit")])],1)],1),e._v(" "),r("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[r("md-icon",[e._v("more")])],1)],1)],1),e._v(" "),r("div",{staticClass:"md-subhead"},[e._v(e._s(e.userRoles))]),e._v(" "),r("div",{staticClass:"md-subhead"},[e._v("Телефон: "+e._s(e.user.profile.phone))])])],1),e._v(" "),r("md-card-media",{attrs:{"md-ratio":"16:9"}},[r("img",{attrs:{src:e.user.profile.avatar}})])],1)],1):r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:!e.user.is_authenticated,expression:"!user.is_authenticated"}],attrs:{"md-icon":"lock","md-label":"Необходима авторизация","md-description":"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации."}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push("/sign_up")}}},[e._v("Зарегистрироваться")])],1),e._v(" "),r("md-dialog-alert",{attrs:{"md-content":"Вы успешно сменили пароль.","md-confirm-text":"Ок","md-active":e.show_dialog},on:{"update:mdActive":function(t){e.show_dialog=t}}})],1)},staticRenderFns:[]};var ae=r("VU/8")(te,re,!1,function(e){r("gEWf")},"data-v-4ecc828e",null).exports,ne=r("X+2x"),se=r.n(ne),ie={name:"create-review",components:{"star-rating":se.a},data:function(){return{user:_.user,review:{order_id:this.$route.params.id,rating:0,text:""},error:null,show_snackbar:!1,snackbar_message:"",show_dialog:!1}},created:function(){p.$on("user-sign-out",this.signOutReviewListener),this.user.is_authenticated||this.showAuthError()},destroyed:function(){p.$off("user-sign-out",this.signOutReviewListener)},methods:{signOutReviewListener:function(){this.$roter.push("/")},onDialogClosed:function(){this.$router.push("/")},showAuthError:function(){this.error={title:"Необходима авторизация",description:"Для продолжения Вам необходимо войти в свой аккаунт. Если Вы ещё не зарегистрированы, то можете это сделать на странице регистрации.",link:"/sign_up",link_text:"Зарегистрироваться",icon:"lock"}},sendReview:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(t.t0=!t.sent,t.t0){t.next=5;break}t.t0=0===e.review.rating;case 5:if(!t.t0){t.next=9;break}return e.snackbar_message="Заполните все данные",e.show_snackbar=!0,t.abrupt("return");case 9:return t.prev=9,e.error=null,p.$emit("global-loading-start"),t.next=14,C.sendReview(e.review);case 14:e.show_dialog=!0,t.next=32;break;case 17:if(t.prev=17,t.t1=t.catch(9),502!==(r=t.t1.response.status)&&504!==r){t.next=24;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,t.abrupt("return");case 24:if(401!==r&&403!==r){t.next=29;break}return e.snackbar_message="Ошибка авторизации",e.show_snackbar=!0,e.showAuthError(),t.abrupt("return");case 29:if(404!==r){t.next=32;break}return e.error={title:"Информация о заявке не найдена",description:"Информация о данной заявке не была найдена. Возможно, вы ошиблись страницей, или заявка была удалена.",link:"/orders",link_text:"К заявкам",icon:"search"},t.abrupt("return");case 32:return t.prev=32,p.$emit("global-loading-finish"),t.finish(32);case 35:case"end":return t.stop()}},t,e,[[9,17,32,35]])}))()}}},oe={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],attrs:{"md-icon":e.error.icon,"md-label":e.error.title,"md-description":e.error.description}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push(e.error.link)}}},[e._v(e._s(e.error.link_text))])],1):r("div",[r("md-card",{staticClass:"review-card"},[r("md-card-header",[r("div",{staticClass:"md-title"},[e._v("Оцените выполнение заказа")])]),e._v(" "),r("md-card-content",[r("div",{staticClass:"rating-form"},[r("md-field",{class:{"md-invalid":e.errors.has("text")}},[r("label",[e._v("Комментарий")]),e._v(" "),r("md-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required|min:10|max:1500",expression:"'required|min:10|max:1500'"}],attrs:{required:"",maxlength:"1500","data-vv-as":"комментарий","data-vv-name":"text"},model:{value:e.review.text,callback:function(t){e.$set(e.review,"text",t)},expression:"review.text"}}),e._v(" "),r("md-icon",[e._v("description")]),e._v(" "),r("span",{staticClass:"md-error"},[e._v(e._s(e.errors.first("text")))])],1),e._v(" "),r("star-rating",{staticClass:"stars",attrs:{"show-rating":!1,"border-width":1},model:{value:e.review.rating,callback:function(t){e.$set(e.review,"rating",t)},expression:"review.rating"}})],1),e._v(" "),r("md-card-actions",[r("md-button",{staticClass:"md-raised md-primary",on:{click:e.sendReview}},[e._v("Отправить")])],1)],1)],1)],1),e._v(" "),r("md-dialog-alert",{attrs:{"md-content":"Отзыв успешно оставлен. Вы будете перенаправлены к главной странице.","md-confirm-text":"Ок","md-active":e.show_dialog},on:{"md-closed":e.onDialogClosed,"update:mdActive":function(t){e.show_dialog=t}}}),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var ce=r("VU/8")(ie,oe,!1,function(e){r("3MuA")},"data-v-f123acfe",null).exports,de={name:"reviews",components:{"star-rating":se.a},data:function(){return{reviews:[],error:null,loading:!1,snackbar_message:"",show_snackbar:!1}},created:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadReviews();case 2:case"end":return t.stop()}},t,e)}))()},methods:{loadReviews:function(){var e=this;return o()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.error=null,p.$emit("global-loading-start"),t.prev=2,t.next=5,C.getAllReviews();case 5:e.reviews=t.sent,t.next=19;break;case 8:if(t.prev=8,t.t0=t.catch(2),502!==(r=t.t0.response.status)&&504!==r){t.next=16;break}return e.snackbar_message="Ошибка доступа к серверу",e.show_snackbar=!0,e.error={title:"Ошибка доступа к серверу",description:"Возникла ошибка при подключении к серверу. Вы можете обновить страницу или вернуться на главную.",link:"/",link_text:"На главную",icon:"error"},t.abrupt("return");case 16:if(404!==r){t.next=19;break}return e.error={title:"Отзывы не найдены",description:"На данный момент отзывы отсутствуют. Вы можете оставить свой отзыв, если Вы пользовались услугами нашего сервиса, на странице заявки.",link:"/",link_text:"На главную",icon:"search"},t.abrupt("return");case 19:return t.prev=19,p.$emit("global-loading-finish"),t.finish(19);case 22:case"end":return t.stop()}},t,e,[[2,8,19,22]])}))()}}},ue={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.error?r("md-empty-state",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],attrs:{"md-icon":e.error.icon,"md-label":e.error.title,"md-description":e.error.description}},[r("md-button",{staticClass:"md-primary md-raised",on:{click:function(t){e.$router.push(e.error.link)}}},[e._v(e._s(e.error.link_text))])],1):r("div",[e.loading?r("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-stroke":3,"md-mode":"indeterminate"}}):e.reviews?r("div",{staticClass:"reviews-container"},e._l(e.reviews,function(t){return r("md-card",{key:t.id,staticClass:"reviews-card",attrs:{"md-with-hover":""}},[r("md-card-header",{staticStyle:{"{margin-left":"0"}},[r("md-avatar",[r("img",{attrs:{src:t.client_profile.avatar,alt:"client"}})]),e._v(" "),r("md-card-header-text",[r("div",{staticClass:"md-title"},[e._v(e._s(t.client_profile.name+" "+t.client_profile.surname))])])],1),e._v(" "),r("md-card-content",{staticClass:"card-content"},[r("div",[e._v(" "+e._s(t.text)+" ")]),e._v(" "),r("star-rating",{staticClass:"stars",attrs:{"show-rating":!1,"read-only":"","star-size":40,"border-width":1},model:{value:t.rating,callback:function(r){e.$set(t,"rating",r)},expression:"review.rating"}})],1)],1)})):e._e()],1),e._v(" "),r("md-snackbar",{attrs:{"md-theme":"default","md-position":"center","md-duration":4e3,"md-active":e.show_snackbar,"md-persistent":""},on:{"update:mdActive":function(t){e.show_snackbar=t}}},[r("span",[e._v(e._s(e.snackbar_message))]),e._v(" "),r("md-button",{staticClass:"md-accent",on:{click:function(t){e.show_snackbar=!1}}},[e._v("Закрыть")])],1)],1)},staticRenderFns:[]};var le=r("VU/8")(de,ue,!1,function(e){r("IQZh")},null,null).exports;a.default.use(E.a);var me=new E.a({routes:[{path:"/",name:"home",component:N},{path:"/sign_up",name:"sign_up",component:Q},{path:"/orders",name:"orders",component:P},{path:"/orders/create",name:"create_order",component:V},{path:"/orders/:id",name:"orderDetail",component:z},{path:"/orders/:id/review",name:"create_review",component:ce},{path:"/myorders",name:"client_orders",component:M},{path:"/profile",name:"profile",component:ae},{path:"/reviews",name:"reviews",component:le}]}),ve=r("Lgyv"),pe=r.n(ve),_e=(r("4+hh"),r("Ryun"),r("sUu7")),he=r("+/GF"),fe=r.n(he);_e.a.localize("ru",fe.a);var ge={locale:"ru",dictionary:{ru:{messages:fe.a}}};a.default.use(pe.a),a.default.use(_e.b,ge),a.default.config.productionTip=!1,_.init(),new a.default({el:"#app",router:me,components:{App:D},template:"<App/>"})},Ryun:function(e,t){},S3rz:function(e,t){},Sp7h:function(e,t){},U85u:function(e,t){},d0a1:function(e,t){},gEWf:function(e,t){},iWm7:function(e,t){},vmyf:function(e,t){},x10d:function(e,t){},yChZ:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.611286ac7240d1e6b228.js.map